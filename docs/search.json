[
  {
    "objectID": "exercises/exercise_block_5.html",
    "href": "exercises/exercise_block_5.html",
    "title": "Exercise - Block 5",
    "section": "",
    "text": "Upon completing this exercise block, you will be able to:\n\nCreate a reusable custom theme function for ggplot2.\nApply a custom theme to standardize the appearance of plots.\nBuild and style publication-ready tables using the gt package.\nCombine ggplot2 plots and gt tables into a single, cohesive figure using patchwork."
  },
  {
    "objectID": "exercises/exercise_block_5.html#learning-objectives",
    "href": "exercises/exercise_block_5.html#learning-objectives",
    "title": "Exercise - Block 5",
    "section": "",
    "text": "Upon completing this exercise block, you will be able to:\n\nCreate a reusable custom theme function for ggplot2.\nApply a custom theme to standardize the appearance of plots.\nBuild and style publication-ready tables using the gt package.\nCombine ggplot2 plots and gt tables into a single, cohesive figure using patchwork."
  },
  {
    "objectID": "exercises/exercise_block_5.html#installing-packages",
    "href": "exercises/exercise_block_5.html#installing-packages",
    "title": "Exercise - Block 5",
    "section": "Installing packages",
    "text": "Installing packages\n\nrenv::install(\"gt\")\nrenv::install(\"patchwork\")"
  },
  {
    "objectID": "exercises/exercise_block_5.html#packages",
    "href": "exercises/exercise_block_5.html#packages",
    "title": "Exercise - Block 5",
    "section": "Packages",
    "text": "Packages\n\nlibrary(ggplot2)\nlibrary(gt)\nlibrary(patchwork)\nlibrary(dplyr)"
  },
  {
    "objectID": "exercises/exercise_block_5.html#exploratory-data-analysis",
    "href": "exercises/exercise_block_5.html#exploratory-data-analysis",
    "title": "Exercise - Block 5",
    "section": "Exploratory data analysis",
    "text": "Exploratory data analysis\n\ndata &lt;- readRDS(gzcon(url(\n  \"https://raw.githubusercontent.com/urppeia/publication_figs/main/data.rds\"\n)))\n\nrownames(data$counts) &lt;- data$counts$Gene_ID\ndata$counts &lt;- data$counts[, -1]"
  },
  {
    "objectID": "exercises/exercise_block_5.html#exercise-1-create-a-universal-theme",
    "href": "exercises/exercise_block_5.html#exercise-1-create-a-universal-theme",
    "title": "Exercise - Block 5",
    "section": "Exercise 1: Create a Universal Theme",
    "text": "Exercise 1: Create a Universal Theme\nTo ensure a consistent style across all our figures, let’s create a custom theme function.\nA. Create a function called theme_course() that returns a theme object.\nB. Inside the function, start with theme_light() and then modify it to do the following:\n-   Make the plot title bold and centered.\n-   Move the legend to the bottom.\n-   Remove minor panel grid lines.\nC. Apply your new theme_course() to a simple scatter plot to test it.\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\n# A & B: Create the theme function\ntheme_course &lt;- function() {\n  theme_light(base_size = 12) +\n    theme(\n      plot.title = element_text(face = \"bold\", hjust = 0.5),\n      legend.position = \"bottom\",\n      panel.grid.minor = element_blank()\n    )\n}\n\n# C: Test the theme\np_test &lt;- ggplot(data$diff, aes(x = sucrose_3h_lfc, y = sucrose_24h_lfc)) +\n  geom_point(alpha = 0.4) +\n  labs(title = \"LFC Correlation\") +\n  theme_course()\n\nprint(p_test)"
  },
  {
    "objectID": "exercises/exercise_block_5.html#exercise-2-create-a-complex-plot-with-the-custom-theme",
    "href": "exercises/exercise_block_5.html#exercise-2-create-a-complex-plot-with-the-custom-theme",
    "title": "Exercise - Block 5",
    "section": "Exercise 2: Create a Complex Plot with the Custom Theme",
    "text": "Exercise 2: Create a Complex Plot with the Custom Theme\nNow, let’s create a more specific plot for our final figure.\nA. Find the Gene ID for the most significantly down-regulated gene at the 24h timepoint.\nB. Create a dataframe for plotting that contains the expression values for this gene, along with the sample annotations (compound and time).\nC. Make a boxplot of expression for this gene.\n-   `time` should be on the x-axis.\n-   The plot should be faceted by `compound`.\n-   The boxes should be filled based on the `time`.\nD. Apply your theme_course() to this plot and give it an appropriate title.\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\n# A: Find the gene\nsig_gene_down &lt;- data$diff %&gt;%\n  filter(sucrose_24h_lfc &lt; 0) %&gt;%\n  arrange(sucrose_24h_pval) %&gt;%\n  pull(Gene_ID) %&gt;%\n  head(1)\n\n# B: Prepare data\nplot_data_ex2 &lt;- data.frame(\n  expression = as.numeric(data$counts[sig_gene_down, ]),\n  compound = data$anno$compound,\n  time = data$anno$time\n)\n\n# C & D: Create the plot\np_boxplot &lt;- ggplot(plot_data_ex2, aes(x = time, y = expression, fill = time)) +\n  geom_boxplot() +\n  facet_wrap(~compound) +\n  theme_course() +\n  labs(\n    title = paste(\"Expression of Gene:\", sig_gene_down),\n    x = \"Timepoint\",\n    y = \"Normalized Expression\"\n  )\n\nprint(p_boxplot)"
  },
  {
    "objectID": "exercises/exercise_block_5.html#exercise-3-create-a-publication-ready-table-with-gt",
    "href": "exercises/exercise_block_5.html#exercise-3-create-a-publication-ready-table-with-gt",
    "title": "Exercise - Block 5",
    "section": "Exercise 3: Create a Publication-Ready Table with gt",
    "text": "Exercise 3: Create a Publication-Ready Table with gt\nLet’s summarize the top differentially expressed genes in a table.\nA. Create a dataframe containing the top 5 up-regulated genes at 24h with a p-value &lt; 0.05. The dataframe should only contain the Gene_ID, sucrose_24h_lfc, and sucrose_24h_pval columns.\nB. Use gt() to create a table from this dataframe.\nC. Style the table:\n-   Add a title: \"Top 5 Up-regulated Genes at 24h\".\n-   Relabel the columns to be more readable (e.g., \"Gene\", \"log2 Fold Change\", \"P-value\").\n-   Format the `log2 Fold Change` column to 2 decimal places.\n-   Format the `P-value` column using scientific notation with 2 decimal places.\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\n# A: Prepare data\ntop_up_genes &lt;- data$diff %&gt;%\n  filter(sucrose_24h_lfc &gt; 0 & sucrose_24h_pval &lt; 0.05) %&gt;%\n  arrange(sucrose_24h_pval) %&gt;%\n  head(5) %&gt;%\n  select(Gene_ID, sucrose_24h_lfc, sucrose_24h_pval)\n\n# B & C: Create and style the gt table\ngt_up_genes &lt;- gt(top_up_genes) %&gt;%\n  tab_header(\n    title = \"Top 5 Up-regulated Genes at 24h\"\n  ) %&gt;%\n  cols_label(\n    Gene_ID = \"Gene\",\n    sucrose_24h_lfc = \"log2 Fold Change\",\n    sucrose_24h_pval = \"P-value\"\n  ) %&gt;%\n  fmt_number(\n    columns = vars(sucrose_24h_lfc),\n    decimals = 2\n  ) %&gt;%\n  fmt_scientific(\n    columns = vars(sucrose_24h_pval),\n    decimals = 2\n  )\n\nWarning: Since gt v0.3.0, `columns = vars(...)` has been deprecated.\n• Please use `columns = c(...)` instead.\nSince gt v0.3.0, `columns = vars(...)` has been deprecated.\n• Please use `columns = c(...)` instead.\n\ngt_up_genes\n\n\n\n\n\n\n\nTop 5 Up-regulated Genes at 24h\n\n\nGene\nlog2 Fold Change\nP-value\n\n\n\n\nAT4G25630\n1.30\n6.58 × 10−7\n\n\nAT5G27120\n1.30\n6.58 × 10−7\n\n\nAT3G18000\n1.30\n1.31 × 10−4\n\n\nAT3G44750\n1.30\n3.49 × 10−4\n\n\nAT3G57150\n1.20\n8.36 × 10−4"
  },
  {
    "objectID": "exercises/exercise_block_5.html#exercise-4-combine-the-plot-and-table",
    "href": "exercises/exercise_block_5.html#exercise-4-combine-the-plot-and-table",
    "title": "Exercise - Block 5",
    "section": "Exercise 4: Combine the Plot and Table",
    "text": "Exercise 4: Combine the Plot and Table\nNow let’s combine the plot from Exercise 2 and the table from Exercise 3 into a single figure.\nA. Use patchwork to combine p_boxplot and gt_up_genes.\nB. The plot should be on top and the table on the bottom.\nC. Adjust the layout so that the plot takes up roughly twice as much height as the table. (Hint: use plot_layout(heights = ...)).\nD. Add an overall title and tags to the combined figure.\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\n# A & B: Combine plot and table\n# Note: patchwork can work directly with gt objects\nfinal_figure &lt;- p_boxplot / gt_up_genes\n\n# C: Adjust layout\nfinal_figure &lt;- final_figure + plot_layout(heights = c(2, 1))\n\n# D: Add annotation\nfinal_figure &lt;- final_figure + plot_annotation(\n  title = \"Gene Expression and Regulation at 24h\",\n  tag_levels = 'A'\n)\n\nprint(final_figure)"
  },
  {
    "objectID": "exercises/exercise_block_5.html#exercise-5-creating-a-complex-multi-panel-figure",
    "href": "exercises/exercise_block_5.html#exercise-5-creating-a-complex-multi-panel-figure",
    "title": "Exercise - Block 5",
    "section": "Exercise 5: Creating a Complex Multi-Panel Figure",
    "text": "Exercise 5: Creating a Complex Multi-Panel Figure\nLet’s combine multiple plots from previous exercises to showcase different patchwork layouts.\nA. Recreate the 24h volcano plot from Exercise 4 of Block 4. Apply your theme_course() and store it in an object named p_volcano.\nB. Recreate the LFC correlation plot (3h vs 24h) from Exercise 1 of Block 4, which includes a regression line. Apply your theme_course() and store it in an object named p_correlation.\nC. Create a nested layout:\n-   Place `p_volcano` and `p_correlation` side-by-side.\n-   Place `p_boxplot` (from Exercise 2 of this block) underneath the other two.\n-   Add a title and tags to the final composition.\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\n# A: Recreate the volcano plot\np_volcano &lt;- ggplot(data$diff, aes(x = sucrose_24h_lfc, y = -log10(sucrose_24h_pval))) +\n  geom_point(aes(color = sucrose_24h_pval &lt; 0.05 & abs(sucrose_24h_lfc) &gt; 1), alpha = 0.5) +\n  theme_course() +\n  scale_color_manual(values = c(\"grey\", \"red\")) +\n  theme(legend.position = \"none\") +\n  labs(title = \"Volcano Plot (24h)\")\n\n# B: Recreate the correlation plot\np_correlation &lt;- ggplot(data$diff, aes(x = sucrose_3h_lfc, y = sucrose_24h_lfc)) +\n  geom_point(alpha = 0.4) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  theme_course() +\n  labs(title = \"LFC Correlation (3h vs 24h)\")\n\n# C: Create the nested layout\nnested_layout &lt;- (p_volcano + p_correlation) / p_boxplot\n\n# Add annotation\nnested_layout + plot_annotation(\n  title = \"Summary of Sucrose Treatment Effects\",\n  tag_levels = \"A\"\n)\n\n`geom_smooth()` using formula = 'y ~ x'"
  },
  {
    "objectID": "exercises/exercise_block_5.html#session-information",
    "href": "exercises/exercise_block_5.html#session-information",
    "title": "Exercise - Block 5",
    "section": "Session information",
    "text": "Session information\n\n\n\n\n\n\nTip\n\n\n\n\n\n\nsessionInfo()\n\nR version 4.5.1 (2025-06-13)\nPlatform: aarch64-apple-darwin20\nRunning under: macOS Tahoe 26.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/Zurich\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n[1] dplyr_1.1.4     patchwork_1.3.2 gt_1.1.0        ggplot2_4.0.0  \n\nloaded via a namespace (and not attached):\n [1] Matrix_1.7-3        gtable_0.3.6        jsonlite_2.0.0     \n [4] compiler_4.5.1      BiocManager_1.30.26 renv_1.1.5         \n [7] tidyselect_1.2.1    xml2_1.4.0          splines_4.5.1      \n[10] scales_1.4.0        yaml_2.3.10         fastmap_1.2.0      \n[13] lattice_0.22-7      R6_2.6.1            labeling_0.4.3     \n[16] generics_0.1.4      knitr_1.50          htmlwidgets_1.6.4  \n[19] tibble_3.3.0        pillar_1.11.1       RColorBrewer_1.1-3 \n[22] rlang_1.1.6         xfun_0.53           fs_1.6.6           \n[25] sass_0.4.10         S7_0.2.0            cli_3.6.5          \n[28] mgcv_1.9-3          withr_3.0.2         magrittr_2.0.4     \n[31] digest_0.6.37       grid_4.5.1          rstudioapi_0.17.1  \n[34] nlme_3.1-168        lifecycle_1.0.4     vctrs_0.6.5        \n[37] evaluate_1.0.5      glue_1.8.0          farver_2.1.2       \n[40] rmarkdown_2.30      tools_4.5.1         pkgconfig_2.0.3    \n[43] htmltools_0.5.8.1"
  }
]